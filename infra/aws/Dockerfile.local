FROM public.ecr.aws/amazonlinux/amazonlinux:2023

# Install sudo for testing (EC2 runs as root by default)
RUN yum install -y sudo

# Create ec2-user (same as EC2)
RUN useradd -m -s /bin/bash ec2-user

# Copy the application files (simulates S3 sync)
COPY ../../dist /home/ec2-user/app

# Set working directory
WORKDIR /home/ec2-user

# Expose the application port
EXPOSE 3000
EXPOSE 80

# The entrypoint will run the setup script
CMD ["/bin/bash"]
